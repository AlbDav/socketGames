<!DOCTYPE html>
<html>
	<head>
		<title>Socket Games</title>
		<link rel='stylesheet' href='/stylesheets/style.css' />
		<link rel='stylesheet' href='/stylesheets/server.css' />
		<script src='/socket.io/socket.io.js'></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
		<script>
		var socket = io();
		var room;
		var messages = ['Bum', 'Boom', 'Bang', 'Bambu', 'Bram', 'Gang', 'Puff'];
		var interval;
		socket.on('connect', function(){
			console.log('connesso');
		});
		socket.on('disconnect', function(){
			console.log('disconnesso');
		});
		socket.on('room_creata', function(roomName){
			room = roomName;
			$('#login').hide();
			$('#game').prepend('<p>Nome room: ' + room + '</p>');
			$('#game').show();
		});
		socket.on('via', function(){
			interval = setInterval(changeText, 1500);
		});
		socket.on('fuoco', function(color){
			clearInterval(interval);
			if(messages.indexOf($('#text').text()) != -1){
				if($('#text').text() == 'Bang'){
					$('#text').text(color + ' vince');
				}
				else{
					$('#text').text(color + ' perde');
				}
			}
		});
		var crea = function(){
			socket.emit('crea', $('#m').val());
		};
		var via = function(){
			socket.emit('via', room);
		};
		var changeText = function(){
			$('#text').text(messages[Math.floor(Math.random() * messages.length)]);
		};
		</script>
	</head>
	<body>
		<div id="table">
			<div id="table-cell">
				<div id="login">
					<input id="m" type='text'>
					<button onClick="javascript:crea()">Crea Stanza</button>
				</div>
				<div id="game">
					<div id="text"></div>
					<button onClick="javascript:via()">Via</button>
				</div>
			</div>
		</div>
	</body>
</html>
